%% stars.web
%% Created by Laurence D. Finston (LDF) Thu 16 Sep 2021 06:16:26 PM CEST

@q * (1) Copyright and License. @>

@q This file is part of GNU 3DLDF, a package for three-dimensional drawing.  @>
@q Copyright (C) 2021 The Free Software Foundation, Inc. @>

@q GNU 3DLDF is free software; you can redistribute it and/or modify  @>
@q it under the terms of the GNU General Public License as published by  @>
@q the Free Software Foundation; either version 3 of the License, or  @>
@q (at your option) any later version.   @>

@q GNU 3DLDF is distributed in the hope that it will be useful,  @>
@q but WITHOUT ANY WARRANTY; without even the implied warranty of  @>
@q MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  @>
@q GNU General Public License for more details.   @>

@q You should have received a copy of the GNU General Public License  @>
@q along with GNU 3DLDF; if not, write to the Free Software  @>
@q Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA @>

@q GNU 3DLDF is a GNU package.   @>
@q It is part of the GNU Project of the   @>
@q Free Software Foundation  @>
@q and is published under the GNU General Public License.  @>
@q See the website http://www.gnu.org  @>
@q for more information.    @>
@q GNU 3DLDF is available for downloading from  @>
@q http://www.gnu.org/software/3dldf/LDF.html. @>

@q Please send bug reports to Laurence.Finston@gmx.de @>
@q The mailing list help-3dldf@gnu.org is available for people to  @>
@q ask other users for help.   @>
@q The mailing list info-3dldf@gnu.org is for sending  @>
@q announcements to users. To subscribe to these mailing lists, send an  @>
@q email with ``subscribe <email-address>'' as the subject.   @>

@q The author can be contacted at:     @>

@q Laurence D. Finston 		       @>
@q c/o Free Software Foundation, Inc.  @>
@q 51 Franklin St, Fifth Floor 	       @>
@q Boston, MA  02110-1301  	       @>
@q USA                                 @>                             

@q Laurence.Finston@gmx.de  @>

@q ** (2) @>

@q ** (2) @>
@
@<Include files@>=

#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>

#include <mysql.h>

#include <ios>
#include <iostream>
#include <iomanip>
#include <iterator>
#include <new>
#include <algorithm>
#include <string> 
#include <exception>
#include <stdexcept>
#include <sstream>   
#include <fstream>   
#include <vector>
#include <deque>

using namespace std;

typedef void* yyscan_t;

#include "parser.hxx"
#include "scanner.hxx"
#include "classes.hxx"
#include "accsgtpt.hxx"

@q ** (2) |class Star| declaration.  @>

@ |class Star| declaration.  

@<|class Star| declaration@>=
class Star
{
      friend int main(int argc, char *argv[]);
      friend int calculate_decimals(vector<Star*> &star_vector);
      friend int query_database_for_stars(string wwhere_str, string oorder_str, int llimit_stars, int ooffset_stars);

      friend bool compare_star_constant_name(Star *, Star *);
      friend bool compare_common_name(Star *s, Star *);
      friend bool compare_flamsteed_designation_number(Star *s, Star *);
      friend bool compare_bayer_designation_greek_letter(Star *s, Star *);
      friend bool compare_bayer_designation_greek_letter_tex(Star *s, Star *);
      friend bool compare_bs_hr_number(Star *s, Star *);
      friend bool compare_bs_number(Star *s, Star *);
      friend bool compare_hr_number(Star *s, Star *);
      friend bool compare_approx_rank_apparent_magnitude(Star *s, Star *);
      friend bool compare_apparent_magnitude(Star *s, Star *); 
      friend bool compare_absolute_magnitude(Star *s, Star *);     
      friend bool compare_constellation_abbreviation(Star *s, Star *);
      friend bool compare_constellation_full_name(Star *s, Star *);
      friend bool compare_constellation_name_genitive(Star *s, Star *);
      friend bool compare_constellation_number(Star *s, Star *);
      friend bool compare_right_ascension_hours(Star *s, Star *t);
      friend bool compare_right_ascension_minutes(Star *s, Star *t);
      friend bool compare_right_ascension_seconds(Star *s, Star *t);
      friend bool compare_right_ascension_decimal_hours(Star *s, Star *t);
      friend bool compare_right_ascension_decimal_degrees(Star *s, Star *t);
      friend bool compare_declination_degrees(Star *s, Star *t);
      friend bool compare_declination_minutes(Star *s, Star *t);
      friend bool compare_declination_seconds(Star *s, Star *t);
      friend bool compare_declination_decimal_degrees(Star *s, Star *t);
      friend bool compare_is_binary(Star *s, Star *t);

      string common_name;                                   
      string greek_name;                                    
      string latin_name;                                    
      string arabic_name;                                   
      int flamsteed_designation_number;                     
      string bayer_designation_greek_letter;                
      string bayer_designation_greek_letter_tex;            
      string bayer_designation_extension;
      int bs_hr_number;                                     
      int approx_rank_apparent_magnitude;                   
      real apparent_magnitude;                              
      real absolute_magnitude;                              
      bool apparent_magnitude_varies;                       
      bool absolute_magnitude_varies;                       
      string constellation_abbreviation;                    
      string constellation_full_name;                       
      string constellation_name_genitive;                   
      int constellation_number;                             
      int right_ascension_hours;                            
      int right_ascension_minutes;                          
      real right_ascension_seconds;                         
      real right_ascension_decimal_hours;                   
      real right_ascension_decimal_degrees;                 
      int declination_degrees;                              
      int declination_minutes;                              
      real declination_seconds;                             
      real declination_decimal_degrees;                     
      int is_binary;                                        
      int is_multiple;
      int is_binary_component;
      int is_eclipsing_binary; 
      string notes;                                                              

   public:                                                  
                                                            
      @<Declare |Star| functions@>@;                        


};

@q ** (2) Star functions.  @>
@ Star functions.  

@q *** (3) Set @>
@ Set.

@q **** (4) Declaration  @>

@<Declare |Star| functions@>=
int 
set(MYSQL_ROW curr_row);

@q **** (4) Definition  @>
@
@<Define |Star| functions@>=
int
Star::set(MYSQL_ROW curr_row)
{
@q ***** (5) @>

   bool DEBUG = false;  /* |true|  */

   if (DEBUG)
      cerr << "Entering `Star::set'." << endl;

   if (curr_row == 0)
   {
       cerr << "ERROR!  In `Star::set':"
                 << endl
                 << "`curr_row' is NULL.  Can't set `Star'."
                 << endl 
                 << "Exiting program unsuccessfully with exit status 1."
                 << endl;

       return 1;

   }

@q ***** (5) @>

      int i = 0;

      common_name = curr_row[i++];
      greek_name = curr_row[i++];
      latin_name = curr_row[i++];
      arabic_name = curr_row[i++];
      flamsteed_designation_number = atoi(curr_row[i++]);
      bayer_designation_greek_letter = curr_row[i++];
      bayer_designation_greek_letter_tex = curr_row[i++];
      bayer_designation_extension = curr_row[i++];
      bs_hr_number = atoi(curr_row[i++]);
      approx_rank_apparent_magnitude = atoi(curr_row[i++]);
      apparent_magnitude = atof(curr_row[i++]);
      absolute_magnitude = atof(curr_row[i++]);
      apparent_magnitude_varies = static_cast<bool>(atoi(curr_row[i++]));
      absolute_magnitude_varies = static_cast<bool>(atoi(curr_row[i++]));
      constellation_abbreviation = curr_row[i++];
      constellation_full_name = curr_row[i++];
      constellation_name_genitive = curr_row[i++];
      constellation_number = atoi(curr_row[i++]);
      right_ascension_hours = atoi(curr_row[i++]);
      right_ascension_minutes = atoi(curr_row[i++]);
      right_ascension_seconds = atof(curr_row[i++]);
      right_ascension_decimal_hours = atof(curr_row[i++]);
      right_ascension_decimal_degrees = atof(curr_row[i++]);
      declination_degrees = atoi(curr_row[i++]);
      declination_minutes = atoi(curr_row[i++]);
      declination_seconds = atof(curr_row[i++]);
      declination_decimal_degrees = atof(curr_row[i++]);
      is_binary = atoi(curr_row[i++]);
      is_multiple = atoi(curr_row[i++]);
      is_binary_component = atoi(curr_row[i++]);
      is_eclipsing_binary = atoi(curr_row[i++]);
      notes = curr_row[i++];

@q ***** (5) @>

   return 0;

}  /* End of |Star::set| definition  */

@q ** (2) @>
@
@<Declare |Star| functions@>=
void 
show(string text) const;

@
@<Define |Star| functions@>=
void 
Star::show(string text) const
{

    bool DEBUG = false; /* |true| */ 

    if (DEBUG)
       cerr << "Entering `Star::show'." << endl;

    if (text == "")
       text = "Star:";

    cerr << "common_name:                         " << common_name << endl
         << "greek_name:                          " << greek_name << endl 
         << "latin_name:                          " << latin_name << endl 
         << "arabic_name:                         " << arabic_name << endl 
         << "flamsteed_designation_number:        " << flamsteed_designation_number << endl 
         << "bayer_designation_greek_letter:      " << bayer_designation_greek_letter << endl 
         << "bayer_designation_greek_letter_tex:  " << bayer_designation_greek_letter_tex << endl 
         << "bayer_designation_extension:         " << bayer_designation_extension << endl 
         << "bs_hr_number:                        " << bs_hr_number << endl 
         << "approx_rank_apparent_magnitude:      " << approx_rank_apparent_magnitude << endl 
         << "apparent_magnitude:                  " << apparent_magnitude << endl 
         << "absolute_magnitude:                  " << absolute_magnitude << endl 
         << "apparent_magnitude_varies:           " << apparent_magnitude_varies << endl 
         << "absolute_magnitude_varies:           " << absolute_magnitude_varies << endl 
         << "constellation_abbreviation:          " << constellation_abbreviation << endl 
         << "constellation_full_name:             " << constellation_full_name << endl 
         << "constellation_name_genitive:         " << constellation_name_genitive << endl 
         << "constellation_number:                " << constellation_number << endl 
         << "right_ascension_hours:               " << right_ascension_hours << endl 
         << "right_ascension_minutes:             " << right_ascension_minutes << endl 
         << "right_ascension_seconds:             " << right_ascension_seconds << endl 
         << "right_ascension_decimal_hours:       " << right_ascension_decimal_hours << endl 
         << "right_ascension_decimal_degrees:     " << right_ascension_decimal_degrees << endl 
         << "declination_degrees:                 " << declination_degrees << endl 
         << "declination_minutes:                 " << declination_minutes << endl 
         << "declination_seconds:                 " << declination_seconds << endl 
         << "declination_decimal_degrees:         " << declination_decimal_degrees << endl 
         << "is_binary:                           " << is_binary << endl
         << "is_multiple:                         " << is_multiple << endl 
         << "is_binary_component:                 " << is_binary_component << endl 
         << "is_eclipsing_binary:                 " << is_eclipsing_binary << endl 
         << "notes:                               " << notes << endl 
         << endl; 

    if (DEBUG)
       cerr << "Exiting `Star::show' successfully with void return value." << endl;

    return;

} /* End of |Star::show| definition.  */

@q *** (3) operator==@>
@ Equality operator (|operator==|).
\initials{LDF 2021.06.24.}

\LOG
\initials{LDF 2021.06.24.}
Added this function.
\ENDLOG

@q **** (4) Declaration  @>

@<Declare |Star| functions@>=
bool
operator==(const Star &s);

@q **** (4) Definition.  @>
@
@<Define |Star| functions@>= 
bool
Star::operator==(const Star &s)
{
   if (bs_hr_number > 0 && s.bs_hr_number > 0 && bs_hr_number == s.bs_hr_number)
   {
      return true;
   }

   if (common_name != "" && s.common_name != "" && common_name == s.common_name)
   {
      return true;
   }

   if (   bayer_designation_greek_letter     != "" && bayer_designation_greek_letter ==  s.bayer_designation_greek_letter
       && bayer_designation_greek_letter_tex != "" && bayer_designation_greek_letter_tex ==  s.bayer_designation_greek_letter_tex
       && constellation_name_genitive        != "" && s.constellation_name_genitive != ""
       && constellation_name_genitive        == s.constellation_name_genitive)
   {
     return true;
   }   

   return false;
}

@q ** (2) Comparison functions for |class Star|.  @>
@ Comparison functions for |class Star|.

@q *** (3) Compare |common_name|.@>
@*7 Compare |common_name|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_common_name(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_common_name(Star *s, Star *t)
{
   return s->common_name < t->common_name;
}

@q *** (3) Compare |flamsteed_designation_number|.@>
@*7 Compare |flamsteed_designation_number|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_flamsteed_designation_number(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_flamsteed_designation_number(Star *s, Star *t)
{
   return s->flamsteed_designation_number < t->flamsteed_designation_number;
}

@q *** (3) Compare |bayer_designation_greek_letter|.@>
@*7 Compare |bayer_designation_greek_letter|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_bayer_designation_greek_letter(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_bayer_designation_greek_letter(Star *s, Star *t)
{
   return s->bayer_designation_greek_letter < t->bayer_designation_greek_letter;
}


@q *** (3) Compare |bayer_designation_greek_letter_tex|.@>
@*7 Compare |bayer_designation_greek_letter_tex|.
\initials{LDF 2021.09.08.}

\LOG
\initials{LDF 2021.09.08.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_bayer_designation_greek_letter_tex(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_bayer_designation_greek_letter_tex(Star *s, Star *t)
{
   return s->bayer_designation_greek_letter_tex < t->bayer_designation_greek_letter_tex;
}


@q *** (3) Compare |bs_hr_number|.@>
@*7 Compare |bs_hr_number|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_bs_hr_number(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_bs_hr_number(Star *s, Star *t)
{
   return s->bs_hr_number < t->bs_hr_number;
}

@q *** (3) Compare |bs_number|.@>
@*7 Compare |bs_number|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_bs_number(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_bs_number(Star *s, Star *t)
{
   return compare_bs_hr_number(s, t);
}

@q *** (3) Compare |hr_number|.@>
@*7 Compare |hr_number|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_hr_number(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_hr_number(Star *s, Star *t)
{
   return compare_bs_hr_number(s, t);
}

@q *** (3) Compare |approx_rank_apparent_magnitude|.@>
@*7 Compare |approx_rank_apparent_magnitude|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_approx_rank_apparent_magnitude(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_approx_rank_apparent_magnitude(Star *s, Star *t)
{
   return s->approx_rank_apparent_magnitude < t->approx_rank_apparent_magnitude;
}

@q *** (3) Compare |apparent_magnitude|.@>
@*7 Compare |apparent_magnitude|.
\initials{LDF 2021.07.10.}

\LOG
\initials{LDF 2021.07.10.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_apparent_magnitude(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_apparent_magnitude(Star *s, Star *t)
{
   return s->apparent_magnitude < t->apparent_magnitude;
}

@q *** (3) Compare |absolute_magnitude|.@>
@*7 Compare |absolute_magnitude|.
\initials{LDF 2021.09.06.}

\LOG
\initials{LDF 2021.09.06.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_absolute_magnitude(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_absolute_magnitude(Star *s, Star *t)
{
   return s->absolute_magnitude < t->absolute_magnitude;
}

@q *** (3) Compare |constellation_abbreviation|.@>
@*7 Compare |constellation_abbreviation|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_constellation_abbreviation(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_constellation_abbreviation(Star *s, Star *t)
{
   return s->constellation_abbreviation < t->constellation_abbreviation;
}

@q *** (3) Compare |constellation_full_name|.@>
@*7 Compare |constellation_full_name|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_constellation_full_name(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_constellation_full_name(Star *s, Star *t)
{
   return s->constellation_full_name < t->constellation_full_name;
}

@q *** (3) Compare |constellation_name_genitive|.@>
@*7 Compare |constellation_name_genitive|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_constellation_name_genitive(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_constellation_name_genitive(Star *s, Star *t)
{
   return s->constellation_name_genitive < t->constellation_name_genitive;
}

@q *** (3) Compare |constellation_number|.@>
@*7 Compare |constellation_number|.
\initials{LDF 2021.06.22.}

\LOG
\initials{LDF 2021.06.22.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_constellation_number(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_constellation_number(Star *s, Star *t)
{
   return s->constellation_number < t->constellation_number;
}

@q *** (3) Compare |compare_right_ascension_hours|.@>
@*7 Compare |compare_right_ascension_hours|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_right_ascension_hours(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_right_ascension_hours(Star *s, Star *t)
{
   return s->right_ascension_hours < t->right_ascension_hours;
}

@q *** (3) Compare |compare_right_ascension_minutes|.@>
@*7 Compare |compare_right_ascension_minutes|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_right_ascension_minutes(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_right_ascension_minutes(Star *s, Star *t)
{
   return s->right_ascension_minutes < t->right_ascension_minutes;
}

@q *** (3) Compare |compare_right_ascension_seconds|.@>
@*7 Compare |compare_right_ascension_seconds|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_right_ascension_seconds(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_right_ascension_seconds(Star *s, Star *t)
{
   return s->right_ascension_seconds < t->right_ascension_seconds;
}

@q *** (3) Compare |compare_right_ascension_decimal_hours|.@>
@*7 Compare |compare_right_ascension_decimal_hours|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_right_ascension_decimal_hours(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_right_ascension_decimal_hours(Star *s, Star *t)
{
   return s->right_ascension_decimal_hours < t->right_ascension_decimal_hours;
}

@q *** (3) Compare |compare_right_ascension_decimal_degrees|.@>
@*7 Compare |compare_right_ascension_decimal_degrees|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_right_ascension_decimal_degrees(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_right_ascension_decimal_degrees(Star *s, Star *t)
{
   return s->right_ascension_decimal_degrees < t->right_ascension_decimal_degrees;
}

@q *** (3) Compare |compare_declination_degrees|.@>
@*7 Compare |compare_declination_degrees|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_declination_degrees(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_declination_degrees(Star *s, Star *t)
{
   return s->declination_degrees < t->declination_degrees;
}

@q *** (3) Compare |compare_declination_minutes|.@>
@*7 Compare |compare_declination_minutes|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_declination_minutes(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_declination_minutes(Star *s, Star *t)
{
   return s->declination_minutes < t->declination_minutes;
}

@q *** (3) Compare |compare_declination_seconds|.@>
@*7 Compare |compare_declination_seconds|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_declination_seconds(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_declination_seconds(Star *s, Star *t)
{
   return s->declination_seconds < t->declination_seconds;
}

@q *** (3) Compare |compare_declination_decimal_degrees|.@>
@*7 Compare |compare_declination_decimal_degrees|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_declination_decimal_degrees(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_declination_decimal_degrees(Star *s, Star *t)
{
   return s->declination_decimal_degrees < t->declination_decimal_degrees;
}

@q *** (3) Compare |compare_is_binary|.@>
@*7 Compare |compare_is_binary|.
\initials{LDF 2021.6.27.}

\LOG
\initials{LDF 2021.6.27.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool
compare_is_binary(Star *s, Star *t);

@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_is_binary(Star *s, Star *t)
{
   return s->is_binary < t->is_binary;
}

@q *** (3) Compare |Star| pointers.@>
@*7 Compare |Star| pointers.
\initials{LDF 2021.06.24.}

\LOG
\initials{LDF 2021.06.24.}
Added this function.
\ENDLOG

@q **** (4) Declaration.  @>
@
@<Declare non-member functions for |class Star|@>=
bool compare_star_pointers(Star *s, Star *t);


@q **** (4) Definition.  @>
@
@<Define non-member functions for |class Star|@>=
bool
compare_star_pointers(Star *s, Star *t)
{
   if (s == 0 || t == 0)
      return false;

   return *s == *t;
}

@q ** (2) Query database for |Stars|.  @>

@ Query database for |Stars|.

@q *** (3) Declaration  @>

@<Function declarations@>=
int
query_database_for_stars(string wwhere_str, string oorder_str, int llimit_stars, int ooffset_stars);

@q *** (3) Definition  @>
@
@<|query_database_for_stars| definition@>=

int
query_database_for_stars(string wwhere_str, string oorder_str, int llimit_stars, int ooffset_stars)
{
@q **** (4) @>

   bool DEBUG = true; /* |false| */ 

   stringstream sql_strm;

   vector<Star*> star_vector;

   if (DEBUG)
   { 
      cerr << "Entering `query_database_for_stars'." << endl;
   }  

   int status = 0;

   Star *star = 0;

   curr_row = 0;

   sql_strm << "select "
            << "common_name, "
            << "greek_name, "
            << "latin_name, "
            << "arabic_name, "
            << "flamsteed_designation_number, "
            << "bayer_designation_greek_letter, "
            << "bayer_designation_greek_letter_tex, "
            << "bayer_designation_extension, "
            << "bs_hr_number, "
            << "approx_rank_apparent_magnitude, "
            << "apparent_magnitude, "
            << "absolute_magnitude, "
            << "apparent_magnitude_varies, "
            << "absolute_magnitude_varies, "
            << "constellation_abbreviation, "
            << "constellation_full_name, "
            << "constellation_name_genitive, "
            << "constellation_number, "
            << "right_ascension_hours, "
            << "right_ascension_minutes, "
            << "right_ascension_seconds, "
            << "right_ascension_decimal_hours, "
            << "right_ascension_decimal_degrees, "
            << "declination_degrees, "
            << "declination_minutes, "
            << "declination_seconds, "
            << "declination_decimal_degrees, "
            << "is_binary, "
            << "is_multiple, "
            << "is_binary_component, "
            << "is_eclipsing_binary "
            << "from Stars ";

      sql_strm << wwhere_str << " " << oorder_str;

      if (llimit_stars > 0)
         sql_strm << " limit " << llimit_stars;

      if (ooffset_stars > 0)
         sql_strm << " offset " << ooffset_stars;

      sql_strm << ";";

      cerr << "`sql_strm.str()' == " << sql_strm.str() << endl;

      status = submit_mysql_query(sql_strm.str());

   sql_strm.str("");

   if (status != 0)
   {
      cerr << "ERROR!"
           << endl
           << "`submit_mysql_query' failed, returning " 
           << status << "." << endl 
           << "MySQL error:  " << mysql_error(mysql)
           << endl 
           << "MySQL error number:  " << mysql_errno(mysql)
           << endl;
   }

   else 
   {
      cerr << "In `query_database_for_stars':"
           << endl
           << "`submit_mysql_query' succeeded, returning 0."
           << endl 
           << "`affected_rows' == " << affected_rows
           << endl 
           << "`row_ctr' == " << row_ctr
           << endl 
           << "`field_ctr' == " << field_ctr
           << endl;
   }

@q **** (4) @>

@ Process the contents of |curr_row|.

@<|query_database_for_stars| definition@>=

   do 
   {
@q ***** (5) @>

       curr_row = mysql_fetch_row(result);

       if (curr_row == 0)
       {

         cerr << "`mysql_fetch_row' returned NULL." 
              << endl;

         if (*mysql_error(mysql))
         {
            cerr << "ERROR!  In `query_database_for_stars':  `mysql_fetch_row' failed "
                 << "returning NULL." << endl
                 << "Error:  " << mysql_error(mysql) << endl
                 << "Exiting function unsuccessfully with return value 1."
                 << endl;

            if (result)
            {
                mysql_free_result(result);
                result = 0;
            }

            return 1;

         }

         else
         {
           cerr << "No more rows." << endl;
          
           break;
         }

       }  /* |if (curr_row == 0)|  */

       else 
       {
#if 0
              cerr << "In `query_database_for_stars':"
                   << endl 
                   << "`mysql_fetch_row' succeeded, `curr_row' is non-NULL."
                   << endl;
#endif 
          }      

         try
         {
            star = new Star;
         }

         catch(bad_alloc)
         {
             cerr << "ERROR! In `query_database_for_stars':"
                  << endl 
                  << "`create_new<Star>' failed.  Rethrowing `bad_alloc'."
                  << endl;

             throw;
         }

#if 0
            cerr << "In `query_database_for_stars':"
                 << endl 
                 << "`new Star' succeeded."
                 << endl;
#endif 

         status = star->set(curr_row);

         if (status != 0)
         {
             cerr << "ERROR! In `query_database_for_stars':"
                  << endl 
                  << "`Star::set' failed, returning " << status << "." << endl
                  << "Exiting function unsuccessfully with return value 1."
                  << endl;

             if (result)
             {
                 mysql_free_result(result);
                 result = 0;
             }         

             exit(1);

         }  /* |if (status != 0)|  */

#if 0
             cerr << "In `query_database_for_stars':"
                  << endl 
                  << "`Star::set' succeeded, returning 0."
                  << endl;
#endif 
  
         star_vector.push_back(star);


@q ***** (5) @>

   } while (curr_row != 0);

@q **** (4) @>
@
@<|query_database_for_stars| definition@>=

   /* Free |result|  */

   if (result)
   {
       mysql_free_result(result);
       result = 0;
   }

   cerr << "star_vector.size() == " << star_vector.size() << endl;


@q **** (4) @>
@
@<|query_database_for_stars| definition@>=

   stringstream s;
   int i = 1;

   if (show_stars > 0)
   {

       if (star_vector.size() > 0)
          cerr << "`star_vector':" << endl;
       else
          cerr << "`star_vector' is empty.  Not showing." << endl;

       for (vector<Star*>::iterator iter = star_vector.begin();
            iter != star_vector.end();
            ++iter)
       {
          s << "Star " << i++ << ":";

          (*iter)->show(s.str());

          s.str("");
       }

       cerr << "Showed " << star_vector.size() << " stars." << endl;   

   }  /* |if| */

@q **** (4) Calculate right ascension decimal hours and decimal degrees and declination decimal degrees.  @>

@ Calculate right ascension decimal hours and decimal degrees and declination decimal degrees.  

@<|query_database_for_stars| definition@>=

   if (decimals_calculate > 0)
   {

       if (DEBUG)
       { 
           cerr << "Calculating right ascension decimal hours and decimal degrees and declination decimal degrees."
                << endl;  
       }     

       status = calculate_decimals(star_vector);

       if (status != 0)
       {
           cerr << "ERROR!  In `query_database_for_stars':  `calculate_decimals' failed, returning " << status << "."
                << endl
                << "Will try to continue."
                << endl;
       }
       else if (DEBUG)
       { 
           cerr << "In `query_database_for_stars':  `calculate_decimals' succeeded, returning 0."
                << endl;
       }   

   }  /* |if (decimals_calculate > 0)|  */

@q **** (4) Write TeX.  @>
@ Write TeX.  
@<|query_database_for_stars| definition@>=

   if (DEBUG)
   { 
      cerr << "In `query_database_for_stars':  `write_tex' == " << write_tex << endl;
   }  

   if (write_tex > 0)
   {
@q ***** (5) @>

       char timestamp_str[32];
       memset(timestamp_str, 0, 32);

#if 0 
       errno = 0;      
       char temp_filename[] = "starinfo_XXXXXX.tex";


       status = mkstemps(temp_filename, 4);

       if (status == -1)
       {
          cerr << "ERROR:  In `query_database_for_stars':  `mkstemps' failed, returning -1:" 
               << endl
               << "Error:  " << strerror(errno)
               << "Not writing TeX file.  Will try to continue." 
               << endl;
       }

@q ***** (5) @>
@
@<|query_database_for_stars| definition@>=
       else
#else
     
       char temp_filename[] = "starinfo_constellations.tex";

#endif 

@q ***** (5) @>
@
@<|query_database_for_stars| definition@>=

       {
@q ****** (6) @>

#if 0 
           if (DEBUG)
           { 
               cerr << "In `query_database_for_stars':"
                    << endl 
                    << "`mkstemps' succeeded, returning file descriptor for file "
                    << "`" << temp_filename << "'."                      
                    << endl;
           }         

           close(status);
#endif 

@q ****** (6) @>

           errno = 0;
           FILE* fp = popen("date +\"%Y.%m.%d %r\"", "r");

           if (fp == 0)
           {
              cerr << "ERROR:  In `query_database_for_stars':  `popen' failed, returning NULL:" 
                   << endl
                   << "Error:  " << strerror(errno)
                   << "Failed to generate timestamp.  Continuing." 
                   << endl;               

           }

@q ****** (6) @>
@
@<|query_database_for_stars| definition@>=

           else 
           {
@q ******* (7) @>

              if (DEBUG)
              { 
                  cerr << "In `query_database_for_stars':"
                       << endl 
                       << "`popen' succeeded, returning FILE pointer."
                       << endl;
              }         
          
@q ******* (7) @>


              errno = 0;
              status = fread(timestamp_str, 1, 32, fp);

              timestamp_str[strlen(timestamp_str) - 1] = '\0';

              if (status == 0)
              {
                  cerr << "ERROR:  In `query_database_for_stars':  `fread' failed, returning 0:" 
                       << endl
                       << "Error:  " << strerror(errno)
                       << "Failed to read timestamp.  Continuing." 
                       << endl;               
              }
              else
              {
                  cerr << "In `query_database_for_stars':  `fread' succeeded, returning " << status << "." 
                       << endl
                       << "`timestamp_str' == " << timestamp_str << endl;

              }
 
              fclose(fp),
              fp = 0;

@q ******* (7) @>

           }  /* |else|  */

@q ****** (6) @>
@
@<|query_database_for_stars| definition@>=

           ofstream out_strm;
           out_strm.open(temp_filename);

           out_strm << "%% " << temp_filename << endl 
                    << "%% Generated by `accsdtbs' " << timestamp_str 
                    << endl << endl;

@q ****** (6) @>
@
@<|query_database_for_stars| definition@>=

           string u;

/* !!START HERE:  LDF 2021.09.12.  Add code for headings with constellations.  Use a different macro */ 
/* instead of \starinfo.   */

           if (constellation_sort)
              stable_sort(star_vector.begin(), star_vector.end(), compare_constellation_full_name);

           string prev_constellation;

           int constellation_ctr = 1;

           string common_name_str;
           string bayer_designation_str;

           for (vector<Star*>::iterator iter = star_vector.begin();
                iter != star_vector.end();
                ++iter)
           {

@q ******* (7) @>

             if ((*iter)->constellation_full_name != prev_constellation)
                out_strm << "\\hbox{{\\largebx " << constellation_ctr++ << ".  " 
                         << (*iter)->constellation_full_name << "}}" 
                         << endl 
                         << "\\vskip\\baselineskip" << endl;

             prev_constellation = (*iter)->constellation_full_name;

             if ((*iter)->approx_rank_apparent_magnitude <= 0)
                continue;
             else if ((*iter)->approx_rank_apparent_magnitude < 10)
                u = "00";
             else if ((*iter)->approx_rank_apparent_magnitude < 100)
                u = "0";
             else 
                u = "";

              common_name_str = (*iter)->common_name;
              bayer_designation_str = (*iter)->bayer_designation_greek_letter_tex;
              bayer_designation_str.append(" ");
              bayer_designation_str.append((*iter)->constellation_name_genitive);

/* !!START HERE:  LDF 2021.09.12.  Figure out a way to get large, bold italic Greek letters in headings. */
/* (Use \fam).  Also, try to get polaris into the generated files.                                       */ 

              if (common_name_str == bayer_designation_str)
                 bayer_designation_str = "";

              out_strm << "%% " << (*iter)->common_name << endl;

              out_strm << "\\bayertoks={" << bayer_designation_str << "}"
                       << "\\starinfo{" << u << (*iter)->approx_rank_apparent_magnitude << "}"
                       << "{" << (*iter)->approx_rank_apparent_magnitude << "}"
                       << "{" << common_name_str << "}"
                       << "{$" << (*iter)->right_ascension_hours << "\\rm{h}\\thinspace "
                       << (*iter)->right_ascension_minutes << "^\\prime\\thinspace "
                       << (*iter)->right_ascension_seconds << "^{\\prime\\prime}$}"
                       << "{$" << (*iter)->declination_degrees << "^\\circ\\thinspace "
                       << (*iter)->declination_minutes << "^\\prime\\thinspace "
                       << (*iter)->declination_seconds << "^{\\prime\\prime}$}"
                       << "{";

@q ******* (7) @>

              if ((    ((*iter)->right_ascension_decimal_degrees >= 337.5)
                    && ((*iter)->right_ascension_decimal_degrees  < 360.0))
                  || (   ((*iter)->right_ascension_decimal_degrees >= 0.0)
                      && ((*iter)->right_ascension_decimal_degrees  < 22.5)))
                 out_strm << "1/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 22.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 67.5))
                 out_strm << "2/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 67.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 112.5))
                 out_strm << "3/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 112.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 157.5))
                 out_strm << "4/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 157.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 202.5))
                 out_strm << "5/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 202.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 247.5))
                 out_strm << "6/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 247.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 292.5))
                 out_strm << "7/";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 247.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 337.5))
                 out_strm << "8/";


@q ******* (7) @>

              if (   ((*iter)->right_ascension_decimal_degrees >= 0.0)
                  && ((*iter)->right_ascension_decimal_degrees  <  22.5))
                 out_strm << "1";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 22.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 45.0))
                 out_strm << "2";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 45.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 67.5))
                 out_strm << "3";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 67.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 90.0))
                 out_strm << "4";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 90.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 112.5))
                 out_strm << "5";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 112.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 135.0))
                 out_strm << "6";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 135.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 157.5))
                 out_strm << "7";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 157.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 180.0))
                 out_strm << "8";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 180.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 202.5))
                 out_strm << "9";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 202.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 225.0))
                 out_strm << "10";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 225.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 247.5))
                 out_strm << "11";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 247.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 270.0))
                 out_strm << "12";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 270.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 292.5))
                 out_strm << "13";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 292.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 315.0))
                 out_strm << "14";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 315.0)
                       && ((*iter)->right_ascension_decimal_degrees  < 337.5))
                 out_strm << "15";

              else if (   ((*iter)->right_ascension_decimal_degrees >= 337.5)
                       && ((*iter)->right_ascension_decimal_degrees  < 360.0))
                 out_strm << "16";

@q ******* (7) @>

              out_strm << "}"
                       << "{" << (*iter)->apparent_magnitude;


              if ((*iter)->apparent_magnitude_varies)
                  out_strm  << "v";

              out_strm << "}{" << (*iter)->absolute_magnitude;

              if ((*iter)->absolute_magnitude_varies)
                  out_strm  << "v";
 
              out_strm << "}{" << (*iter)->constellation_full_name << "}" << endl;


           }

@q ****** (6) @>
@
@<|query_database_for_stars| definition@>=

           out_strm << endl 
                    << "%% Local" << " Variables:" << endl 
                    << "%% mode:plain-TeX"         << endl 
                    << "%% auto-fill-function:nil" << endl 
                    << "%% abbrev-mode:t"          << endl 
                    << "%% End:"                   << endl 
                    << endl;

           out_strm.close();

           cerr << "Wrote TeX code to file " << temp_filename << endl;
 
@q ****** (6) @>

       }  /* |else| (or end-of-group) */

@q ***** (5) @>

   }  /* |if (write_tex > 0)|  */
     
@q **** (4) @>
@
@<|query_database_for_stars| definition@>=

#if 0 /* 1   */

   int prev_bs_hr_number = 0;

   cerr << "Duplicates:" << endl;

   for (vector<Star*>::iterator iter = star_vector.begin();
       iter != star_vector.end(); 
       ++iter)
   {
       if ((*iter)->bs_hr_number == prev_bs_hr_number)
          cerr << prev_bs_hr_number << endl;
        
       prev_bs_hr_number = (*iter)->bs_hr_number;
   }
#endif 

@q **** (4) @>

   if (DEBUG)
   { 
      cerr << "Exiting `query_database_for_stars' successfully with return value 0." 
           << endl;
   }  

   return 0;

}  /* End of |query_database_for_stars| definition  */

@q ** (2) Calculate decimals.  @>

@ Calculate decimals.

@q *** (3) Declaration  @>

@<Function declarations@>=
int
calculate_decimals(vector<Star*> &star_vector);

@q *** (3) Definition  @>
@
@<|calculate_decimals| definition@>=
int
calculate_decimals(vector<Star*> &star_vector)
{
@q **** (4) @>

   bool DEBUG = true; /* |false| */ 

   stringstream sql_strm;

   float ra_decimal_hours;
   float decl_decimal_degrees;

   int status = 0;
   
   int decl_sign;

   cerr << "Entering `calculate_decimals'." << endl
        << "Calculating right_ascension_decimal_hours and `declination_decimal_degrees'." 
        << endl; 

   cerr << "`star_vector.size()' == " << star_vector.size() << endl;

   if (star_vector.size() == 0)
   {
      cerr << "In `calculate_decimals':" << endl 
           << "`star_vector' is empty."  << endl 
           << "Exiting function successfully with return value 0." 
           << endl;

      return 0;
   }

@q **** (4) @>

   for (vector<Star*>::iterator iter = star_vector.begin();
       iter != star_vector.end(); 
       ++iter)
   {
@q ***** (5) @>

      if (   (*iter)->right_ascension_decimal_hours != 0
          && (*iter)->right_ascension_decimal_degrees != 0
          && (*iter)->declination_decimal_degrees != 0)
      {
           cerr << "For star ";

           if (!(*iter)->common_name.empty())
              cerr << (*iter)->common_name << ", ";

           cerr << (*iter)->bayer_designation_greek_letter << " " 
                << (*iter)->constellation_abbreviation << ":" << endl
                << "`right_ascension_decimal_hours', "
                << "`right_ascension_decimal_degrees' and"
                << endl 
                << "`declination_decimal_degrees' are all non-zero."
                << endl 
                << "No need to calculate them.  Continuing." << endl;

           continue;  

      }  /* |if|  */

@q ***** (5) @>
@
@<|calculate_decimals| definition@>=

      ra_decimal_hours =   (*iter)->right_ascension_hours + ((*iter)->right_ascension_minutes / 60.0)
                         + ((*iter)->right_ascension_seconds / 3600.0);

      if ((*iter)->declination_degrees >= 1)
          decl_sign = 1;
      else
          decl_sign = -1;

      decl_decimal_degrees = decl_sign * (abs((*iter)->declination_degrees) + ((*iter)->declination_minutes / 60.0)
                         + ((*iter)->declination_seconds / 3600.0));

      if (ra_decimal_hours == 0.0 && decl_decimal_degrees == 0.0)
      {

           cerr << "For star ";

           if (!(*iter)->common_name.empty())
              cerr << (*iter)->common_name << ", ";

           cerr << (*iter)->bayer_designation_greek_letter << " " 
                << (*iter)->constellation_abbreviation << ":" << endl
                << "`ra_decimal_degrees' and `decl_decimal_degrees' are both 0.0."
                << endl 
                << "Not updating database for star.  Continuing." << endl;

         continue;
      }

@q ***** (5) @>
@
@<|calculate_decimals| definition@>=

      sql_strm << "update Stars set ";

      if (ra_decimal_hours != 0)
         sql_strm << "right_ascension_decimal_hours = " << ra_decimal_hours;

      if (ra_decimal_hours != 0 && decl_decimal_degrees != 0)
         sql_strm  << ", ";

      if (decl_decimal_degrees != 0)
         sql_strm  << "declination_decimal_degrees = " << decl_decimal_degrees;

      sql_strm << " where bs_hr_number = " << (*iter)->bs_hr_number;

      cerr << "`sql_strm.str()' == " << sql_strm.str() << endl;

      status = submit_mysql_query(sql_strm.str());

      cerr << "`submit_mysql_query' returned " << status << endl;
 
      sql_strm.str("");

      cerr << endl;

@q ***** (5) @>

   }  /* |for|  */

@q **** (4) @>

   if (DEBUG)
   { 
      cerr << "Exiting `calculate_decimals' successfully with return value 0." << endl;
   }  

   return 0;

}  /* End of |calculate_decimals| definition  */


@q *** (3) @>
@
@(stars.hxx@>=
@<|class Star| declaration@>@;
@<Declare non-member functions for |class Star|@>@;
@<Function declarations@>@;

@q *** (3) @>
@
@c
@<Include files@>@;
typedef float real;
int submit_mysql_query(string query_str);
extern MYSQL_RES *result;
extern MYSQL_ROW curr_row;
extern MYSQL *mysql;
extern unsigned int row_ctr; 
extern unsigned int field_ctr;
extern long affected_rows;
@<|class Star| declaration@>@;
@<Function declarations@>@;
@<Declare non-member functions for |class Star|@>@;
@<Define |Star| functions@>@;
@<Define non-member functions for |class Star|@>@;
extern vector<Star*> star_vector;
@<|query_database_for_stars| definition@>@;
@<|calculate_decimals| definition@>@;

/* Local Variables:       */
/* mode:CWEB              */
/* auto-fill-function:nil */
/* End:                   */

